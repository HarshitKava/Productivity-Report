{% load static %}
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>URC Construction</title>
        <link rel="icon" type="image/x-icon" href="https://www.urcindia.com/img/favicon.ico">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
        <link rel="stylesheet" href="{% static '/css/SLI/SLIAddDayData.css' %}">
    </head>
  <body>
    <nav style="z-index: 1; top:0px;" class="namebar" ><p style="display: inline;" id="nam">{{ request.user }}</p>-<p style="display: inline;" id="area">{{ Areaname}}</p><div id="ar_id" style="visibility: hidden;display: none;" >{{Areaname_id}}</div></nav>
    <table id='display' style='font-size:120%;'>
      <tr>
        <th>AreaName</th>
        <th>Contractor<br>Name</th>
        <th>Labour Category</th>
        <th>No. of Labour</th>
        <th>No. of Helper</th>
        <th>Delete</th>
      </tr>
      {% for i in Report %}
      <tr>
        <!-- <td>{{ i.created_at }}</td> -->
        <td>{{ i.Areaname }}</td>
        <td>{{ i.ContractorName }}</td>
        <td>{{ i.LabourCategory }}</td>
        <td>{{ i.NoLabor }}</td>
        <td>{{ i.NoHelp }}</td>
        <td><a href="{% url 'DeleteNightSLI' i.id i.Areaname i.ContractorName i.LabourCategory i.NoLabor i.NoHelp %}">Delete</a></td>
        
      </tr>
      {% endfor %}
      
        
    <tr>
    <form action="" id="form" method="POST" data-labour-url="{% url 'ajax_load_labour' %}">
      {% csrf_token %}
      <div style="visibility: visible ;">
        <td>{{form.Areaname}}</td>
        </div>
        <td>{{form.ContractorName}}</td>
        <td>{{form.LabourCategory}}</td>
        <td>{{form.NoLabor}}</td>
        <td>{{form.NoHelp}}</td>
            
          <td><input type="submit" name="submit" class="submitbtn"></td>
    </form>
  </tr>
  </table>
    <div style="z-index: 1;" id="navbar"><p id="date"></p>
    <a href="{% url 'HomeSLI' %}" class="bkbtn">Home</a></div>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <script src="{% static '/js/SLI/form.js' %}" async defer></script>
    <script>
        
        $("#id_ContractorName").change(function(){
          console.log("changed");
          const url=$("#form").attr("data-labour-url");
          const contractorId=$(this).val();
          $.ajax({
            url:url,
            data:{
              'contractor_id':contractorId
            },
            success:function(data){
              console.log(data);
              $("#id_LabourCategory").html(data);
            }
          });
        })

    </script>
  </body>
</html>